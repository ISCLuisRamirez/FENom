<div class="content-wrapper container-xxl p-0">
  <div class="content-body">
    <section class="app-denuncia-view">

      <div class="row">
        <!-- Sección Informacion de la denuncia -->
        <div class="col-md-6">
          <div class="card denuncia-card">
            <div class="card-body">
              <h5 class="text-primary">Información de la Denuncia</h5>
              <div class="d-flex flex-wrap my-50">
                <span class="card-text font-weight-bold mb-0">
                  <strong>Folio: </strong>{{ data.folio }}
                </span>
              </div>
              <hr>
              <div class="denuncia-details">
                <div class="d-flex flex-wrap my-50">
                  <div class="denuncia-info-title">
                    <i data-feather="flag" class="mr-1"></i>
                    <span class="card-text denuncia-info-title font-weight-bold mb-0">
                      <strong>Medio de denuncia:</strong> {{ getMedio(data.id_via) }}
                    </span>
                  </div>
                </div>

                <div class="d-flex flex-wrap my-50">
                  <div class="denuncia-info-title">
                    <i data-feather="flag" class="mr-1"></i>
                    <span class="card-text denuncia-info-title font-weight-bold mb-0">
                      <strong>Información del medio:</strong> {{ data.via_detail }}
                    </span>
                  </div>
                </div>

                <div class="d-flex flex-wrap my-50">
                  <div class="denuncia-info-title">
                    <i data-feather="check" class="mr-1"></i>
                    <span class="card-text denuncia-info-title font-weight-bold mb-0">
                      <strong>Tipo de denuncia:</strong> {{ getreason(data.id_reason) }}
                    </span>
                  </div>
                </div>

                <div class="d-flex flex-wrap my-50">
                  <div class="denuncia-info-title">
                    <i data-feather="map-pin" class="mr-1"></i>
                    <span class="card-text denuncia-info-title font-weight-bold mb-0">
                      <strong>Ubicación:</strong> {{ getLocation(data.id_location) }}
                    </span>
                  </div>
                </div>

                <div class="d-flex flex-wrap my-50">
                  <div class="denuncia-info-title">
                    <i data-feather="calendar" class="mr-1"></i>
                    <span class="card-text denuncia-info-title font-weight-bold mb-0">
                      <strong>Fecha del suceso:</strong> {{ data.date }}
                    </span>
                  </div>
                </div>

                <div class="d-flex flex-wrap my-50">
                  <div class="denuncia-info-title">
                    <i data-feather="calendar" class="mr-1"></i>
                    <span class="card-text denuncia-info-title font-weight-bold mb-0">
                      <strong>Periodo aproximado:</strong> {{ data.period }}
                    </span>
                  </div>
                </div>

                <div class="d-flex flex-wrap my-50">
                  <div class="denuncia-info-title">
                    <i data-feather="info" class="mr-1"></i>
                    <span class="card-text denuncia-info-title font-weight-bold mb-0">
                      <strong>Descripción del incidente:</strong> {{ data.description }}
                    </span>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
        <!-- Sección Estatus -->
        <div class="col-md-6">
          <div class="card denuncia-card">
            <div class="card-body">
              <h5 class="text-primary">Estado de la Denuncia</h5>
              <hr>
              <!-- Current Status -->
              <div class="d-flex flex-wrap my-50">
                <div class="denuncia-info-title">
                  <i data-feather="alert-circle" class="mr-1"></i>
                  <span class="card-text denuncia-info-title font-weight-bold mb-0">
                    Estatus actual: 
                  </span>
                  {{ getStatusString(data.status) }}
                </div>
              </div>

              <!-- Previous Report Status -->
              <div class="d-flex flex-wrap my-50">
                <div class="denuncia-info-title">
                  <i data-feather="info" class="mr-1"></i>
                  <span class="card-text denuncia-info-title font-weight-bold mb-0">
                    <strong>¿Se ha reportado previamente?</strong> pendiente
                  </span>
                </div>
              </div>


              <div class="d-flex flex-wrap my-50">
                <div class="denuncia-info-title">
                  <i data-feather="info" class="mr-1"></i>
                  <span class="card-text denuncia-info-title font-weight-bold mb-0">
                    <strong>Descripción del reporte:</strong> pendiente
                  </span>
                </div>
              </div><br>

              <div class="d-flex flex-wrap my-50">
                <div class="denuncia-info-title">
                  <i data-feather="calendar" class="mr-1"></i>
                  <span class="card-text denuncia-info-title font-weight-bold mb-0">
                    <strong>Ultimo cambio de estatus por:</strong> {{ getemployee(data.id_user_updated) }}
                  </span>
                </div>
              </div>


              <div class="d-flex flex-wrap my-50">
                <div class="denuncia-info-title">
                  <i data-feather="calendar" class="mr-1"></i>
                  <span class="card-text denuncia-info-title font-weight-bold mb-0">
                    <strong>Fecha de creación:</strong> {{ data.created_date }}
                  </span>
                </div>
              </div>

              <div class="d-flex flex-wrap my-50">
                <div class="denuncia-info-title">
                  <i data-feather="calendar" class="mr-1"></i>
                  <span class="card-text denuncia-info-title font-weight-bold mb-0">
                    <strong>Fecha de modificación:</strong> {{ data.updated_date }}
                  </span>
                </div>
              </div>

              <div class="d-flex flex-wrap my-50">
                <div class="denuncia-info-title">
                  <i data-feather="calendar" class="mr-1"></i>
                  <span class="card-text denuncia-info-title font-weight-bold mb-0">
                    <strong>Fecha de cierre:</strong> {{ data.closed_date }}
                  </span>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
      <!-- Sección Implicados -->
      <div class="row">
        <div class="col-md-6">
          <div class="card denuncia-card">
            <div class="card-body">
              <h5 class="text-primary">Implicados</h5>
              <hr>
              <div class="table-responsive">
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th>Nombre</th>
                      <th>Puesto</th>
                      <th>Número de empleado</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let implicado of implicados">
                      <td>{{ implicado.name }}</td>
                      <td>{{ implicado.position }}</td>
                      <td>{{ implicado.employee_number }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <!-- End Table for Involved People -->
            </div>
          </div>
        </div>

        <!-- Tabla de Testigos -->
        <div class="col-md-6">
          <div class="card denuncia-card">
            <div class="card-body">
              <h5 class="text-primary">Testigos</h5>
              <hr>

              <!-- Table for Witnesses -->
              <div class="table-responsive">
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th>Nombre</th>
                      <th>Puesto</th>
                      <th>Número de empleado</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let testigo of testigos">
                      <td>{{ testigo.name }}</td>
                      <td>{{ testigo.position }}</td>
                      <td>{{ testigo.employee_number }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <!-- End Table for Witnesses -->
            </div>
          </div>
        </div>
      </div>
      <!-- Sección Info del solicitante -->
      <div class="row">
        <div class="col-md-12">
          <div class="card denuncia-card">
            <div class="card-body">
              <h5 class="text-primary">Información del Solicitante</h5>
              <hr>

              <!-- Applicant Information -->
              <div class="applicant-info">
                <!-- Verifica que row[0] exista antes de acceder a sus propiedades -->
                <div class="d-flex flex-wrap my-50" *ngIf="row && row.length > 0">
                  <div class="denuncia-info-title">
                    <i data-feather="user" class="mr-1"></i>
                    <span class="card-text denuncia-info-title font-weight-bold mb-0">
                      <strong>Nombre: </strong>{{ row[0].name }}
                    </span>
                  </div>
                </div>

                <div class="d-flex flex-wrap my-50" *ngIf="row && row.length > 0">
                  <div class="denuncia-info-title">
                    <i data-feather="mail" class="mr-1"></i>
                    <span class="card-text denuncia-info-title font-weight-bold mb-0">
                      <strong>Correo Electrónico: </strong>{{ row[0].email }}
                    </span>
                  </div>
                </div>

                <div class="d-flex flex-wrap my-50" *ngIf="row && row.length > 0">
                  <div class="denuncia-info-title">
                    <i data-feather="phone" class="mr-1"></i>
                    <span class="card-text denuncia-info-title font-weight-bold mb-0">
                      <strong>Teléfono: </strong>{{ row[0].phone }}
                    </span>
                  </div>
                </div>

                <div class="d-flex flex-wrap my-50" *ngIf="row && row.length > 0">
                  <div class="denuncia-info-title">
                    <i data-feather="map-pin" class="mr-1"></i>
                    <span class="card-text denuncia-info-title font-weight-bold mb-0">
                      <strong>Número de empleado: </strong>{{ row[0].employee_number }}
                    </span>
                  </div>
                </div>

                <div class="d-flex flex-wrap my-50" *ngIf="row && row.length > 0">
                  <div class="denuncia-info-title">
                    <i data-feather="map-pin" class="mr-1"></i>
                    <span class="card-text denuncia-info-title font-weight-bold mb-0">
                      <strong>Puesto: </strong>{{ row[0].position }}
                    </span>
                  </div>
                </div>
              </div>
              <!-- End Applicant Information -->
            </div>
          </div>
        </div>
      </div>
      <!-- Sección archivos adjuntos -->
      <div class="row">
        <!-- Archivos Adjuntos Section -->
        <div class="col-md-6">
          <div class="card denuncia-card">
            <div class="card-body">
              <h5 class="text-primary">Archivos Adjuntos</h5>
              <hr>
              <!-- Aquí podrías usar *ngFor si recibes un array de archivos en tu API -->
              <div class="file-list">
                <div class="file-item d-flex justify-content-between align-items-center my-2">
                  <a href="#" class="file-name text-truncate">Archivo1.pdf</a>
                  <button class="btn btn-link btn-sm">Ver</button>
                </div>
                <div class="file-item d-flex justify-content-between align-items-center my-2">
                  <a href="#" class="file-name text-truncate">Imagen2.jpg</a>
                  <button class="btn btn-link btn-sm">Ver</button>
                </div>
                <div class="file-item d-flex justify-content-between align-items-center my-2">
                  <a href="#" class="file-name text-truncate">Documento3.png</a>
                  <button class="btn btn-link btn-sm">Ver</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Estatus Change Section -->
        <div class="col-md-6">
          <div class="card denuncia-card">
            <div class="card-body">
              <h5 class="text-primary">Cambio de Estatus</h5>
              <hr>

              <!-- Formulario Reactivo para cambiar estatus -->
              <form [formGroup]="statusForm" (ngSubmit)="actualizarStatus()">
                <div class="d-flex flex-wrap my-50">
                  <div class="denuncia-info-title">
                    <i data-feather="settings" class="mr-1"></i>
                    <span class="card-text denuncia-info-title font-weight-bold mb-0 p-2">
                      Cambiar Estatus de la Denuncia:
                    </span>
                  </div>
                  <div>
                    <!-- Si deseas que '1', '2', '3' sean números en el form, usa [ngValue] -->
                    <select class="form-control" id="denunciaStatus" formControlName="status">
                      <option [ngValue]="1">En proceso</option>
                      <option [ngValue]="2">Abierto</option>
                      <option [ngValue]="3">Cerrado</option>
                    </select>
                  </div>
                </div>

                <!-- Botones dentro del formulario -->
                <div class="d-flex justify-content-end mt-3">
                  <!-- type="button" para que NO envíe el formulario -->
                  <button type="button" class="btn btn-secondary mr-2" routerLink="/tables/datatables">
                    Cancelar
                  </button>

                  <!-- type="submit" para que SÍ envíe el formulario y dispare (ngSubmit) -->
                  <button type="submit" class="btn btn-primary">
                    Guardar
                  </button>
                </div>
              </form>
              <!-- Fin del formulario -->
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>
